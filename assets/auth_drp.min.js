/*
 * Â© 2025 Darpan Adhikari. All rights reserved.
 *
 * This software is copyrighted and may not be copied,
 * sold, redistributed, or reused in part or full without explicit written permission.
 *
 * Any attempt to replicate or misuse this code without permission is strictly prohibited.
 */
import{initializeApp}from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";import{getAuth,signInWithEmailAndPassword,createUserWithEmailAndPassword,signOut,sendPasswordResetEmail,onAuthStateChanged,setPersistence,browserSessionPersistence}from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";import{getFirestore,doc,getDoc,setDoc,updateDoc,onSnapshot,enableIndexedDbPersistence}from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";const firebaseConfig={apiKey:"AIzaSyDv4eWnf5bgL-Wf8nwhvyEBd6pWeL6ThC4",authDomain:"hour.darpanadhikari.com.np",projectId:"hourcounter-4cc68",storageBucket:"hourcounter-4cc68.appspot.com",messagingSenderId:"355904559029",appId:"1:355904559029:web:ac9e88b70c2a8c05666bfc",measurementId:"G-9C7KWDTL1Y"};export const app=initializeApp(firebaseConfig);export const auth=getAuth(app);export const db=getFirestore(app);export const user=auth.currentUser;const toast=document.getElementById('toast');export function toastMsg(msg){toast.textContent=msg;toast.classList.remove('hidden');setTimeout(()=>toast.classList.add('hidden'),2000);}export function getCurrentUserEmail(){return new Promise((resolve)=>{onAuthStateChanged(auth,(user)=>{resolve(user?user.email:null);});});}export function loginEmail(email,password){return signInWithEmailAndPassword(auth,email,password);}export async function registerEmail(email,password){const cred=await createUserWithEmailAndPassword(auth,email,password);const uid=cred.user.uid;await setDoc(doc(db,"users",uid),{email,storage:{},ongoing:{}},{merge:true});return cred;}export function logout(){return signOut(auth);}export function resetPassword(email){return sendPasswordResetEmail(auth,email).then(()=>{console.log("Password reset email sent!");toastMsg("Password reset email sent!Check your inbox.");}).catch((error)=>{console.error(error.message);toastMsg("Error:"+error.message);});}export{onAuthStateChanged};